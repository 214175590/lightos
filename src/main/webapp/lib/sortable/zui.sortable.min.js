/*!
 * ZUI: 排序 - v1.5.0 - 2016-09-06
 * http://zui.sexy
 * GitHub: https://github.com/easysoft/zui.git 
 * Copyright (c) 2016 cnezsoft.com; Licensed MIT
 */
+function(t,e,r,s){"use strict";if(!t.fn.droppable)return void console.error("Sortable requires droppable.js");var n=function(e,r){this.$=t(e),this.options=this.getOptions(r),this.init()};n.DEFAULTS={selector:"li, div",dragCssClass:"invisible"},n.prototype.getOptions=function(e){return e=t.extend({},n.DEFAULTS,this.$.data(),e)},n.prototype.init=function(){this.bindEventToList(this.$.children(this.options.selector))},n.prototype.reset=function(){var e=this,r=this.$.children(this.options.selector).not(".drag-shadow");r.each(function(){var s=t(this);return s.data("zui.droppable")?(s.data("zui.droppable").options.target=r,void s.droppable("reset")):(e.bindEventToList(r),!1)})},n.prototype.bindEventToList=function(e){function r(e){var r=[];e.each(function(){var e=t(this).data("order");"number"==typeof e&&r.push(e)}),r.sort(function(t,e){return t-e});for(var s=e.length;r.length<s;)r.push(r.length?r[r.length-1]+1:0);o&&r.reverse();var n=0;e.each(function(){t(this).attr("data-order",r[n++])})}var s=this.$,n=this.options,o=n.reverse;r(e),e.droppable({trigger:n.trigger,target:s.children(n.selector),container:s,always:n.always,flex:!0,before:n.before,start:function(e){n.dragCssClass&&e.element.addClass(n.dragCssClass),t.zui.callEvent(n.start)},drag:function(e){if(s.addClass("sortable-sorting"),e.isIn){var i=e.element,a=e.target,l=i.attr("data-order"),d=a.attr("data-order");if(l==d)return;l>d?a[o?"after":"before"](i):a[o?"before":"after"](i);var c=s.children(n.selector).not(".drag-shadow");r(c),t.zui.callEvent(n.order,{list:c,element:i})}},finish:function(e){n.dragCssClass&&e.element&&e.element.removeClass(n.dragCssClass),t.zui.callEvent(n.finish,{list:s.children(n.selector),element:e.element}),s.removeClass("sortable-sorting")}})},t.fn.sortable=function(e){return this.each(function(){var r=t(this),s=r.data("zui.sortable"),o="object"==typeof e&&e;s?"object"==typeof e&&s.reset():r.data("zui.sortable",s=new n(this,o)),"string"==typeof e&&s[e]()})},t.fn.sortable.Constructor=n}(jQuery,window,document,Math);